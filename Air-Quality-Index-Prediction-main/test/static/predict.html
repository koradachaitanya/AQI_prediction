<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQI Prediction System - Predict</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/lucide-icons/dist/umd/lucide.css" rel="stylesheet">
    <style>
        .aqi-meter {
            height: 2rem; /* This ensures the container has rounded edges */
            overflow:hidden;
            display: flex;
            position: relative;
        }
        
        .aqi-segment {
            flex: 1;
        }
        
        .aqi-marker {
            position: absolute;
            top: -0.5rem;
            width: 1rem;
            height: 1rem;
            background-color: white;
            border: 2px solid #f1f5f9;
            border-radius: 9999px; /* Makes the marker circular */
            transform: translateX(-50%);
        }

        .tooltip {
            display: none;
            background-color: #1e293b;
            border: 1px solid #475569;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
            width: 350px;
            margin-top: 4px;
        }

        .info-button {
            cursor: pointer;
            float: right;
            margin-left: 4px;
            color: #60a5fa;
        }

        .relative {
            position: relative;
        }

        .disclaimer {
            background-color: #334155;
            padding: 10px;
            margin: 15px 0;
            border-left: 5px solid #f0ad4e;
            font-size: 0.9em;
            color: #e2e8f0;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 to-slate-800">
    <div class="container mx-auto px-4 py-8">
        <div class="flex items-center justify-between mb-8">
            <a href="/" class="flex items-center text-blue-400 hover:text-blue-300">
                <i data-lucide="arrow-left" class="w-6 h-6 mr-2"></i>
                Back to Home
            </a>
            <div class="flex items-center">
                <i data-lucide="activity" class="w-8 h-8 text-blue-400 mr-2"></i>
                <h1 class="text-4xl font-bold text-blue-400">AQI Prediction</h1>
            </div>
            <div class="w-24"></div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-slate-800 rounded-lg shadow-xl p-8 border border-slate-700">
                <h2 class="text-2xl font-semibold mb-6 text-slate-100">Enter AQI Parameters</h2>
                <form id="predict-form">
                    <div class="form-group mb-6 relative">
                        <label for="pm25" class="block text-sm font-medium text-slate-300">
                            Particulate Matter (PM2.5) (μg/m³): <span class="text-slate-400">[Range: 0-500]</span>
                            <span class="info-button" onclick="toggleTooltip('pm25-tooltip', this)">ℹ</span>
                        </label>
                        <div id="pm25-tooltip" class="tooltip">
                            <strong>Description:</strong> Fine particles that can penetrate deep into the lungs.<br>
                            <strong>Common Sources:</strong> Vehicle exhaust, industrial processes, etc.<br>
                            <strong>Health Impacts:</strong> High levels: causes respiratory issues.<br>
                            Low levels : low levels are in good range and do not cause harm.
                        </div>
                        <input type="number" id="pm25" name="pm25" required class="shadow appearance-none border border-slate-600 rounded w-full py-2 px-3 bg-slate-700 text-slate-100 leading-tight focus:outline-none focus:shadow-outline focus:border-blue-400">
                    </div>
                    <div class="form-group mb-6 relative">
                        <label for="no2" class="block text-sm font-medium text-slate-300">
                            Nitrogen Dioxide (NO2) (ppb): <span class="text-slate-400">[Range: 0-2000]</span>
                            <span class="info-button" onclick="toggleTooltip('no2-tooltip', this)">ℹ</span>
                        </label>
                        <div id="no2-tooltip" class="tooltip">
                            <strong>Description:</strong> A reddish-brown gas primarily from vehicle emissions.<br>
                            <strong>Health Impacts:</strong> High levels :causes inflammation of airways.
                            Low Levels:low levels are in good ranga and do not cause majoe harm  to health.
                        </div>
                        <input type="number" id="no2" name="no2" required class="shadow appearance-none border border-slate-600 rounded w-full py-2 px-3 bg-slate-700 text-slate-100 leading-tight focus:outline-none focus:shadow-outline focus:border-blue-400">
                    </div>
                    <div class="form-group mb-6 relative">
                        <label for="o3" class="block text-sm font-medium text-slate-300">
                            Ozone (O3) (ppb): <span class="text-slate-400">[Range: 0-500]</span>
                            <span class="info-button" onclick="toggleTooltip('o3-tooltip', this)">ℹ</span>
                        </label>
                        <div id="o3-tooltip" class="tooltip">
                            <strong>Description:</strong> Ground-level ozone formed by chemical reactions.<br>
                            <strong>Health Impacts:</strong> High levels : triggers chest pain and coughing.
                            Low levels: Low levels are good in range and protects su from uv rays when in stratosphere.
                        </div>
                        <input type="number" id="o3" name="o3" required class="shadow appearance-none border border-slate-600 rounded w-full py-2 px-3 bg-slate-700 text-slate-100 leading-tight focus:outline-none focus:shadow-outline focus:border-blue-400">
                    </div>
                    <div class="form-group mb-6 relative">
                        <label for="co" class="block text-sm font-medium text-slate-300">
                            Carbon Monoxide (CO) (ppb): <span class="text-slate-400">[Range: 1-1000]</span>
                            <span class="info-button" onclick="toggleTooltip('co-tooltip', this)">ℹ</span>
                        </label>
                        <div id="co-tooltip" class="tooltip">
                            <strong>Description:</strong> An odorless, colorless gas from incomplete combustion.<br>
                            <strong>Health Impacts:</strong> High levels: can reduce oxygen delivery to organs.
                            Low levels: even low levels can cause some harm to earth by reflecting sunlight and causing global warming.
                        </div>
                        <input type="number" id="co" name="co" required class="shadow appearance-none border border-slate-600 rounded w-full py-2 px-3 bg-slate-700 text-slate-100 leading-tight focus:outline-none focus:shadow-outline focus:border-blue-400">
                    </div>
                    <div class="button-container text-center mt-6">
                        <button type="button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-lg transform transition-transform hover:scale-105" onclick="submitPrediction()">Submit</button>
                    </div>
                </form>
            </div>
            <div class="bg-slate-800 rounded-lg shadow-xl p-8 border border-slate-700">
                <h2 class="text-2xl font-semibold mb-6 text-slate-100">Prediction Results</h2>
                <div id="result" class="text-center text-slate-400">
                    Enter parameters and generate a prediction to see results
                </div>
                <div class="aqi-meter mt-6 rounded-full">
                    <div class="aqi-segment" style="background-color: #00E400;" title="Good (0–50)"></div>
                    <div class="aqi-segment" style="background-color: #FFDD44;" title="Moderate (51–100)"></div>
                    <div class="aqi-segment" style="background-color: #FF7E00;" title="Unhealthy for Sensitive Groups (101–150)"></div>
                    <div class="aqi-segment" style="background-color: #FF0000;" title="Unhealthy (151–200)"></div>
                    <div class="aqi-segment" style="background-color: #8F3F97;" title="Very Unhealthy (201–300)"></div>
                    <div class="aqi-segment" style="background-color: #7E0023;" title="Hazardous (301–500)"></div>
                    <div class="aqi-marker" id="aqi-marker"></div>
                
                </div>

                <div class="disclaimer">
                    <strong>Disclaimer:</strong> The predictions provided by this application are for informational purposes only and may not be entirely accurate. Please consult official sources for precise air quality information.
                </div>
                
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        function toggleTooltip(id, button) {
            const tooltips = document.querySelectorAll('.tooltip');
            tooltips.forEach(tooltip => tooltip.style.display = 'none');
            const tooltip = document.getElementById(id);
            tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';
        }

        function submitPrediction() {
            const pm25 = parseFloat(document.getElementById('pm25').value);
            const no2 = parseFloat(document.getElementById('no2').value);
            const o3 = parseFloat(document.getElementById('o3').value);
            const co = parseFloat(document.getElementById('co').value);

            if (isNaN(pm25) || isNaN(no2) || isNaN(o3) || isNaN(co)) {
                alert('Please enter valid values for all parameters.');
                return;
            }

            fetch('http://127.0.0.1:8081/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    features: [pm25, no2, o3, co]
                }),
            })
            .then(response => response.json())
            .then(data => {
                const resultDiv = document.getElementById('result');
                const marker = document.getElementById('aqi-marker');
                if (data.error) {
                    resultDiv.innerHTML = `<p style="color: #fca5a5;">Error: ${data.error}</p>`;
                } else {
                    resultDiv.innerHTML = `<h3 style="color: #f1f5f9;">Prediction: ${data.prediction}</h3><div style="color: #e2e8f0;">${data.suggestion}</div>`;
                    const aqiPercentage = Math.min(100, Math.max(0, (data.prediction / 500) * 100));
                    marker.style.left = `${aqiPercentage}%`;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while making the prediction.');
            });
        }
    </script>
</body>
</html>